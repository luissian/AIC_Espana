{% extends 'aicespana/base.html' %}
{% load static %}
{% block content %}
{% include "aicespana/cdn_table_functionality.html" %}
<div class="container-md">
	<div class="col">
	    <div class="card">
	        <div class="card-header text-center"><h2>Listado de Proyectos</h2> </div>
            <div class="card-body">
                <div class="row mt-3 justify-content-center">
                    <div class="col">
                        <ul class="nav nav-tabs" id="myTab" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="listado-tab" data-bs-toggle="tab" data-bs-target="#listado" type="button" role="tab" aria-controls="listado" aria-selected="true">Listado</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="stats-tab" data-bs-toggle="tab" data-bs-target="#stats" type="button" role="tab" aria-controls="stats" aria-selected="false">Estadisticas</button>
                            </li>
                        </ul>
                        <div class="tab-content" id="myTabContent">
                            <div class="tab-pane fade show active" id="listado" role="tabpanel" aria-labelledby="listado-tab">
                                <div class="container-md">
                                    <div class="row mt-1">
                                        <div class="col">
                                            <table id="projecto_tabla" class="table table-striped table-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Delegacion</th>
                                                        <th>Diocesis</th>
                                                        <th>Grupo</th>
                                                        <th>Nombre Proyecto</th>
                                                        <th>Fecha Alta</th>
                                                        <th>Fecha Baja</th>
                                                        <th>Memoria del projecto</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for proj, proj_id, grp_id, grp, dioc , deleg, alta, baja, activo, memoria, photo in project_data.p_list %}
                                                        <tr>
                                                            <td>{{deleg}}</td>
                                                            <td>{{dioc}}</td>
                                                            <td><a href="listadoGrupo={{grp_id}}">{{grp}}</a></td>
                                                            <td>{{proj}}</td>
                                                            <td>{{alta}}</td>
                                                            <td>{{baja}}</td>
                                                            <td>
                                                                {% if  memoria != "" %}
                                                                    <a href="{{memoria}}">descargar memoria</a>
                                                                {% endif %}
                                                            </td>
                                                        </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>  
                                    </div> 
                                </div> 
                            </div>
                            <div class="tab-pane fade" id="stats" role="tabpanel" aria-labelledby="stats-tab">
                                <div class="container-md">
                                    <div class="row mt-1">
                                        <div class="col">
                                            <div class="card">
                                                <div class="card-body">
                                                    <div class="row justify-content-center">
                                                        <div class="col-md-8">
                                                            {{ project_data.graphics.num_project | safe }}
                                                        </div>
                                                    </div>
                                                </div>  
                                            </div> 
                                        </div> 
                                    </div>
                                </div>  
                            </div> 
                        </div> 
                    </div>
                </div> 
			</div>  
		</div> 
	</div> 
</div> 
<script type="text/javascript">
    $(document).ready(function() {
        $('#projecto_tabla').DataTable({
            dom: "fltirpB",
            responsive: true,
            buttons: [
                'excel'
            ]
        });
    });
</script>
{% endblock %}
